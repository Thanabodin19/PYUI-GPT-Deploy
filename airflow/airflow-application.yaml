apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: airflow
  namespace: argocd
spec:
  destination:
    server: https://kubernetes.default.svc
    namespace: default  # หรือ namespace ที่คุณต้องการ deploy
  project: default  # หรือ project ที่คุณตั้งค่าใน ArgoCD
  source:
    repoURL: https://github.com/Thanabodin19/PYUI-GPT-Deploy.git  # URL ของ Git repository ที่เก็บไฟล์ Chart.yaml และ values.yaml
    targetRevision: helm-airflow  # หรือ branch/tag ที่ต้องการใช้งาน
    path: airflow  # path ใน repository ที่มี Chart.yaml และ values.yaml
    helm:
      valueFiles:
        - values.yaml  # ชี้ไปที่ไฟล์ values.yaml
  syncPolicy:
    automated:
      prune: true
      selfHeal: true
    syncOptions:
      - CreateNamespace=true  # ถ้าต้องการให้ ArgoCD สร้าง namespace อัตโนมัติ
